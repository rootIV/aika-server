unit PingBackForm;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls,
  IdHTTPServer, IdCustomHTTPServer, IdContext, Classes,
  StrUtils, IdServerIOHandler;

type
  TfrmPingback = class(TForm)
    memLog: TMemo;
    btnClearLog: TButton;
  private
    { Private declarations }
  public
    { Public declarations }
  end;


type
  TPingbackServer = class(TObject)
    Requests: TIdHTTPServer;

  private
    procedure OnGetCommand(AContext: TIdContext;
      ARequestInfo: TIdHTTPRequestInfo; AResponseInfo: TIdHTTPResponseInfo);

    function GetActive: Boolean;
    procedure SetActive(Active: Boolean);
  public
    property IsActive: Boolean read GetActive write SetActive;

    constructor Create;
    function StartServer: Boolean;
    procedure CloseServer;

    function RequestControl(URL: string; Param: TStrings): string;
  end;

var
  frmPingback: TfrmPingback;

implementation

{$R *.dfm}

end.
